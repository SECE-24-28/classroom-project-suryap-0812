<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Load</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <button class="mx-auto block mt-10 px-4 py-2 bg-blue-500 text-white rounded" id="ld">Load Users</button>
    <input type="text" class="text-center w-64 flex justify-center mx-auto mt-6" placeholder="Search by title" id="ip">
    

    <div class="res"></div>

    <!-- <script>
        let ld = document.getElementById("ld");
        var dat = fetch("https://jsonplaceholder.typicode.com/users")
                    .then(response => response.json())
                    .then(data => data); // Store fetched data

        var data = fetch("https://jsonplaceholder.typicode.com/users")
                    .then(response => response.json())
                    .then(data => {
                        ld.addEventListener("click", function(){
                            for(let i = 0; i < data.length; i++){
                                var p = document.createElement("p");
                                p.innerHTML = `<div class='border-2 border-gray-400 m-2 mx-16 p-2 rounded-lg shadow-lg'>
                                                <h2 class='text-2xl font-bold mb-2'>${data[i].name}</h2>
                                                <p class='text-gray-700'><b>Email:</b> ${data[i].email}</p>
                                                <p class='text-gray-700'> <b>City:</b> ${data[i].address.city}</p>
                                               </div>`;
                                document.querySelector(".res").appendChild(p);
                            }
                        })
                    });

        let ip = document.getElementById("ip");
        ip.addEventListener("keyup", function(){
            let searchValue = ip.value.toLowerCase();
            document.querySelector(".res").innerHTML = ""; 
            for(let i = 0; i < dat.length; i++){
                if(dat[i].name.toLowerCase().includes(searchValue)){
                    var p = document.createElement("p");
                    p.innerHTML = `<div class='border-2 border-gray-400 m-2 mx-16 p-2 rounded-lg shadow-lg'>
                                    <h2 class='text-2xl font-bold mb-2'>${dat[i].name}</h2>
                                    <p class='text-gray-700'><b>Email:</b> ${dat[i].email}</p>
                                    <p class='text-gray-700'> <b>City:</b> ${dat[i].address.city}</p>
                                   </div>`;
                    document.querySelector(".res").appendChild(p);
                }
            }
        });
    </script> -->

<script>
    let ld = document.getElementById("ld");
    let users = []; // store resolved data

    fetch("https://jsonplaceholder.typicode.com/users")
      .then(response => response.json())
      .then(data => {
          users = data; // save for later use
          ld.addEventListener("click", function(){
              renderUsers(users);
          });
      })
      .catch(err => console.error(err));

    function renderUsers(list){
        const container = document.querySelector(".res");
        container.innerHTML = "";
        list.forEach(user => {
            const p = document.createElement("p");
            p.innerHTML = `<div class='border-2 border-gray-400 m-2 mx-16 p-2 rounded-lg shadow-lg'>
                                <table>

                                    <h2 class='text-2xl font-bold mb-2'>${user.name}</h2>
                                    <p class='text-gray-700'><b>Email:</b> ${user.email}</p>
                                    <p class='text-gray-700'><b>City:</b> ${user.address.city}</p>
                                </table>
                           </div>`;
            container.appendChild(p);
        });
    }

    let ip = document.getElementById("ip");
    ip.addEventListener("keyup", function(){
        const searchValue = ip.value.toLowerCase();
        const filtered = users.filter(u => u.name.toLowerCase().includes(searchValue));
        renderUsers(filtered);
    });
</script>

</body>
</html>